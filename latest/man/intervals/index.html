<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="no-js ie6"><![endif]-->
<!--[if IE 7 ]><html class="no-js ie7"><![endif]-->
<!--[if IE 8 ]><html class="no-js ie8"><![endif]-->
<!--[if IE 9 ]><html class="no-js ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    
      
        <title>Intervals - Bio.jl</title>
      
      
      
        <link rel="canonical" href="https://biojulia.github.io/Bio.jl/man/intervals/">
      
      
        <meta name="author" content="The BioJulia Organisation">
      
    
    <meta property="og:url" content="https://biojulia.github.io/Bio.jl/man/intervals/">
    <meta property="og:title" content="Bio.jl">
    <meta property="og:image" content="https://biojulia.github.io/Bio.jl/man/intervals//../../images/biojl.png">
    <meta name="apple-mobile-web-app-title" content="Bio.jl">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
      <link rel="apple-touch-icon" href="../../images/biojl.png">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="../../None">
    <link rel="icon" type="image/x-icon" href="../../None">
    <style>
      @font-face {
      	font-family: 'Icon';
      	src: url('../../assets/fonts/icon.eot?52m981');
      	src: url('../../assets/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
      		   url('../../assets/fonts/icon.woff?52m981')
               format('woff'),
      		   url('../../assets/fonts/icon.ttf?52m981')
               format('truetype'),
      		   url('../../assets/fonts/icon.svg?52m981#icon')
               format('svg');
      	font-weight: normal;
      	font-style: normal;
      }
    </style>
    <link rel="stylesheet" href="../../assets/stylesheets/application-54f87043f3.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/palettes-05ab2406df.css">
    
    
      
      
      
      <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu+Mono">
      <style>
        body, input {
          font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
        }
        pre, code {
          font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
        }
      </style>
    
    
      <link rel="stylesheet" href="../../assets/Documenter.css">
    
    <script src="../../assets/javascripts/modernizr-4ab42b99fd.js"></script>
    
  </head>
  
  
  
  <body class="palette-primary-indigo palette-accent-blue">
    
      
      
    
    <div class="backdrop">
      <div class="backdrop-paper"></div>
    </div>
    <input class="toggle" type="checkbox" id="toggle-drawer">
    <input class="toggle" type="checkbox" id="toggle-search">
    <label class="toggle-button overlay" for="toggle-drawer"></label>
    <header class="header">
      <nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        
          <span class="path">
            
              
                Manual <i class="icon icon-link"></i>
              
            
          </span>
        
        Intervals
      </div>
    </div>
    
    
      
      <div class="button button-github" role="button" aria-label="GitHub">
        <a href="https://github.com/BioJulia" title="@BioJulia on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
      </div>
    
    <div class="button button-search" role="button" aria-label="Search">
      <label class="toggle-button icon icon-search" title="Search" for="toggle-search"></label>
    </div>
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
    </header>
    <main class="main">
      
      <div class="drawer">
        <nav aria-label="Navigation">
  
  <a href="https://github.com/BioJulia/Bio.jl" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="../../images/biojl.png">
        </div>
      
      <div class="name">
        <strong>
          Bio.jl
          <span class="version">
            
          </span>
        </strong>
        
          <br>
          BioJulia/Bio.jl
        
      </div>
    </div>
  </a>
  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            
            <a href="https://github.com/BioJulia/Bio.jl/archive/master.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/BioJulia/Bio.jl/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      
      <div class="toc">
        <ul>
          
            
  <li>
    <a class="" title="Home" href="../..">
      Home
    </a>
    
  </li>

          
            
  <li>
    <span class="section">Manual</span>
    <ul>
      
        
  <li>
    <a class="" title="Installation" href="../install/">
      Installation
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="IO API" href="../reading/">
      IO API
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Biological Sequences" href="../seq/">
      Biological Sequences
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Alignments" href="../alignments/">
      Alignments
    </a>
    
  </li>

      
        
  <li>
    <a class="current" title="Intervals" href="./">
      Intervals
    </a>
    
      
        
      
      
        <ul>
          
            <li class="anchor">
              <a title="Interval types" href="#interval-types">
                Interval types
              </a>
            </li>
          
            <li class="anchor">
              <a title="Collections of intervals" href="#collections-of-intervals">
                Collections of intervals
              </a>
            </li>
          
            <li class="anchor">
              <a title="Intersection" href="#intersection">
                Intersection
              </a>
            </li>
          
            <li class="anchor">
              <a title="Interval streams" href="#interval-streams">
                Interval streams
              </a>
            </li>
          
        </ul>
      
    
  </li>

      
        
  <li>
    <a class="" title="Structure" href="../structure/">
      Structure
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Tools" href="../tools/">
      Tools
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Reference</span>
    <ul>
      
        
  <li>
    <a class="" title="Seq" href="../../lib/seq/">
      Seq
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <a class="" title="Contributing" href="../contributing/">
      Contributing
    </a>
    
  </li>

          
        </ul>
        
          <hr>
          <span class="section">The author</span>
          <ul>
            
            
              
              <li>
                <a href="https://github.com/BioJulia" target="_blank" title="@BioJulia on GitHub">
                  @BioJulia on GitHub
                </a>
              </li>
            
          </ul>
        
      </div>
    </div>
  </div>
</nav>
      </div>
      <article class="article">
        <div class="wrapper">
          
          <p><a id='Intervals:-Genomic-Interval-Manipulation-1'></a></p>
<h1 id="intervals-genomic-interval-manipulation">Intervals: Genomic Interval Manipulation</h1>
<p>The <code>Intervals</code> module consists of tools for working efficiently with genomic intervals.</p>
<p><a id='Interval-types-1'></a></p>
<h2 id="interval-types">Interval types</h2>
<p>Intervals in Bio.jl are consistent with ranges in Julia: <em>1-based and end-inclusive</em>. When data is read from formats with different representations (i.e. 0-based and/or end-exclusive) they are always converted automatically. Similarly when writing data. You should not have to reason about off-by-one errors due to format differences while using functionality provided in Bio.jl.</p>
<p>The <code>Interval</code> type is defined as</p>
<div class="codehilite"><pre><span></span><span class="k">type</span><span class="nc"> Interval</span><span class="p">{</span><span class="n">T</span><span class="p">}</span> <span class="o">&lt;:</span> <span class="n">AbstractInterval</span><span class="p">{</span><span class="kt">Int64</span><span class="p">}</span>
    <span class="n">seqname</span><span class="p">::</span><span class="n">ASCIIString</span>
    <span class="n">first</span><span class="p">::</span><span class="kt">Int64</span>
    <span class="n">last</span><span class="p">::</span><span class="kt">Int64</span>
    <span class="n">strand</span><span class="p">::</span><span class="n">Strand</span>
    <span class="n">metadata</span><span class="p">::</span><span class="n">T</span>
<span class="k">end</span>
</pre></div>


<p>Similarly to the <code>ReqRecord</code> type in the <code>Seq</code> module, <code>Interval</code> is parameterized on metadata type, which lets it efficiently and precisely be specialized to represent intervals from a variety of formats.</p>
<p>Strand is represented by the <code>Strand</code> type which can take four possible values:</p>
<div class="codehilite"><pre><span></span><span class="n">STRAND_NA</span>   <span class="c"># strand is unknown or inapplicable</span>
<span class="n">STRAND_POS</span>  <span class="c"># positive strand</span>
<span class="n">STRAND_NEG</span>  <span class="c"># negative strand</span>
<span class="n">STRAND_BOTH</span> <span class="c"># non-strand-specific feature</span>
</pre></div>


<p><a id='Collections-of-intervals-1'></a></p>
<h2 id="collections-of-intervals">Collections of intervals</h2>
<p>Collections of intervals are represented using the <code>IntervalCollection</code> type, which is a general purpose indexed container for intervals. It supports fast intersection operations as well as insertion, deletion, and sorted iteration.</p>
<p>Interval collections can be initialized by inserting elements one by one using <code>push!</code>.</p>
<div class="codehilite"><pre><span></span><span class="c"># The type parameter (Nothing here) indicates the interval metadata type.</span>
<span class="n">incol</span> <span class="o">=</span> <span class="n">IntervalCollection</span><span class="p">{</span><span class="kt">Nothing</span><span class="p">}()</span>

<span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="p">:</span><span class="mi">100</span><span class="p">:</span><span class="mi">10000</span>
    <span class="n">push!</span><span class="p">(</span><span class="n">incol</span><span class="p">,</span> <span class="n">Interval</span><span class="p">(</span><span class="s">&quot;chr1&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">99</span><span class="p">,</span> <span class="n">STRAND_POS</span><span class="p">,</span> <span class="n">nothing</span><span class="p">))</span>
<span class="k">end</span>
</pre></div>


<p>Incrementally building an interval collection like this works, but <code>IntervalCollection</code> also has a bulk insertion constructor that is able to build the indexed data structure extremely efficiently from an array of intervals.</p>
<div class="codehilite"><pre><span></span><span class="n">incol</span> <span class="o">=</span> <span class="n">IntervalCollection</span><span class="p">([</span><span class="n">Interval</span><span class="p">(</span><span class="s">&quot;chr1&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">99</span><span class="p">,</span> <span class="n">STRAND_POS</span><span class="p">,</span> <span class="n">nothing</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="p">:</span><span class="mi">100</span><span class="p">:</span><span class="mi">10000</span><span class="p">])</span>
</pre></div>


<p>Bulding <code>IntervalCollections</code> in one shot like this should be preferred when it's convenient or speed in an issue.</p>
<p><a id='Intersection-1'></a></p>
<h2 id="intersection">Intersection</h2>
<p>There are number of <code>intersect</code> function in the Intervals module. They follow two patterns: interval versus collection queries which return an iterator over intervals in the collection that intersect the query, and collection versus collection queries which iterate over all pairs of intersecting intervals.</p>
<p><a id='Base.intersect' href='#Base.intersect'>#</a>
<strong><code>Base.intersect</code></strong> &mdash; <em>Function</em>.</p>
<div class="codehilite"><pre><span></span>intersect(s1,s2...)
∩(s1,s2)
</pre></div>


<p>Construct the intersection of two or more sets. Maintains order and multiplicity of the first argument for arrays and ranges.</p>
<p>Intersect two <code>IntervalStreams</code> returning an iterator over all pairs of intersecting intervals.</p>
<p>Iterate over pairs of intersections in an IntervalCollection versus an IntervalStream.</p>
<p>Iterate over pairs of intersecting intervals in two IntervalCollections</p>
<p>Return an iterator over all intervals in the collection that overlap the query interval.</p>
<p><a id='Interval-streams-1'></a></p>
<h2 id="interval-streams">Interval streams</h2>
<p>Intervals need not necessarily stored in an indexed data structure for efficient intersection to be practical. Two collections of intervals need only be both sorted to compute all intersecting pairs. This is particularly useful in genomics where datasets are sometimes so large that loading them entirely into memory is not practical.</p>
<p>The Intervals module is able to intersect any two iterators that yield intervals in sorted order, which we refer to as "interval streams". An <code>IntervalCollection</code> is also a interval stream, but so is a sorted array of intervals, and parsers over interval file formats. This allows for a very general notion of intersection.</p>
<div class="codehilite"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">in</span> <span class="n">intersect</span><span class="p">(</span><span class="n">open</span><span class="p">(</span><span class="s">&quot;x_features.bed&quot;</span><span class="p">,</span> <span class="n">BED</span><span class="p">),</span> <span class="n">open</span><span class="p">(</span><span class="s">&quot;y_features.bed&quot;</span><span class="p">,</span> <span class="n">BED</span><span class="p">))</span>
    <span class="n">println</span><span class="p">(</span><span class="s">&quot;Intersection found between &quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s">&quot; and &quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>


<p>An exception will be thrown if an interval in encountered out of order while processing an interval stream. Ordering of intervals has one complication: there is not necessarily a standardized way to order sequence names. By default in Bio.jl intervals are sorted using a special <code>alphanum_isless</code> comparison function that compares numbers numerically if they exist in string, so that names like <code>chr1, chr2, chr10</code> end up in their natural order.</p>
<p>The <code>intersect</code> function takes as an optional parameter an <code>isless</code> function to use to compare sequence names to account for arbitrary sequence name orderings.</p>
<div class="codehilite"><pre><span></span><span class="c"># assume lexigraphic ordering for sequence names</span>
<span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">in</span> <span class="n">intersect</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">isless</span><span class="p">)</span>
    <span class="n">println</span><span class="p">(</span><span class="s">&quot;Intersection found between &quot;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="s">&quot; and &quot;</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="k">end</span>
</pre></div>


<p>A special sort of intersection can also be performed on a <code>IntervalStreams</code> against itself to produce "coverage intervals".</p>
<p><a id='Bio.Intervals.coverage' href='#Bio.Intervals.coverage'>#</a>
<strong><code>Bio.Intervals.coverage</code></strong> &mdash; <em>Function</em>.</p>
<p>Compute the coverage of a collection of intervals.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><code>intervals</code>: any IntervalStream</li>
</ul>
<p><strong>Returns</strong></p>
<p>An IntervalCollection that contains run-length encoded coverage data.</p>
<p>E.g. for intervals like</p>
<p>```{execute="false"}
    [------]     [------------]
       [---------------]</p>
<div class="codehilite"><pre><span></span>this function would return a new set of disjoint intervals with annotated coverage like:

```{execute=&quot;false&quot;}
    [1][-2-][-1-][--2--][--1--]
</pre></div>
          <aside class="copyright" role="note">
            
              Copyright (c) 2016 The BioJulia Organisation &ndash;
            
            Documentation built with
            <a href="http://www.mkdocs.org" target="_blank">MkDocs</a>
            using the
            <a href="http://squidfunk.github.io/mkdocs-material/" target="_blank">
              Material
            </a>
            theme.
          </aside>
          
            <footer class="footer">
              
  <nav class="pagination" aria-label="Footer">
    <div class="previous">
      
        <a href="../alignments/" title="Alignments">
          <span class="direction">
            Previous
          </span>
          <div class="page">
            <div class="button button-previous" role="button" aria-label="Previous">
              <i class="icon icon-back"></i>
            </div>
            <div class="stretch">
              <div class="title">
                Alignments
              </div>
            </div>
          </div>
        </a>
      
    </div>
    <div class="next">
      
        <a href="../structure/" title="Structure">
          <span class="direction">
            Next
          </span>
          <div class="page">
            <div class="stretch">
              <div class="title">
                Structure
              </div>
            </div>
            <div class="button button-next" role="button" aria-label="Next">
              <i class="icon icon-forward"></i>
            </div>
          </div>
        </a>
      
    </div>
  </nav>

            </footer>
          
        </div>
      </article>
      <div class="results" role="status" aria-live="polite">
        <div class="scrollable">
          <div class="wrapper">
            <div class="meta"></div>
            <div class="list"></div>
          </div>
        </div>
      </div>
    </main>
    <script>
      var base_url = '../..';
      var repo_id  = 'BioJulia/Bio.jl';
    </script>
    <script src="../../assets/javascripts/application-997097ee0c.js"></script>
    
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
    
      <script src="../../assets/mathjaxhelper.js"></script>
    
    
  </body>
</html>