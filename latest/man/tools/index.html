<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <meta name="author" content="The BioJulia Organisation"> 
    <link rel="canonical" href="https://biojulia.github.io/Bio.jl/man/tools/"> 
    <link rel="shortcut icon" href="../../img/favicon.ico">

    <title>Tools - Bio.jl</title>

    <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.018/css/hack.min.css">
    <link href='//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../../css/base.css" rel="stylesheet">
    <link href="../../css/biojulia.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <link rel="stylesheet" href="../../css/friendly.css" type="text/css">
    <link href="../../assets/Documenter.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
    <script>
    WebFont.load({
        google: {
            families: ['Open Sans', 'PT Sans']
        }
    });
    </script>

    
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../..">Bio.jl</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../..">Home</a>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Manual <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../install/">Installation</a>
</li>

                        
                            
<li >
    <a href="../reading/">IO API</a>
</li>

                        
                            
<li >
    <a href="../seq/">Biological Sequences</a>
</li>

                        
                            
<li >
    <a href="../alignments/">Alignments</a>
</li>

                        
                            
<li >
    <a href="../intervals/">Intervals</a>
</li>

                        
                            
<li >
    <a href="../var/">Biological Variation</a>
</li>

                        
                            
<li >
    <a href="../structure/">Structure</a>
</li>

                        
                            
<li class="active">
    <a href="./">Tools</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reference <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../lib/seq/">Seq</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li >
                        <a href="../contributing/">Contributing</a>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li >
                        <a rel="next" href="../structure/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../../lib/seq/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
                    <li>
                        <a href="https://github.com/BioJulia/Bio.jl">
                            
                                <i class="fa fa-github"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="first-level active"><a href="#biotools-misc-tools-and-function-wrappers">Bio.Tools: Misc tools and function wrappers</a></li>
        
            <li class="second-level"><a href="#blast-wrapper">BLAST wrapper</a></li>
            
                <li class="third-level"><a href="#the-basics">The Basics</a></li>
            
                <li class="third-level"><a href="#options-for-blastn-and-blastp">Options for blastn and blastp</a></li>
            
        
    
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<p><a id='Bio.Tools:-Misc-tools-and-function-wrappers-1'></a></p>
<h1 id="biotools-misc-tools-and-function-wrappers">Bio.Tools: Misc tools and function wrappers</h1>
<p><a id='BLAST-wrapper-1'></a></p>
<h2 id="blast-wrapper">BLAST wrapper</h2>
<p>The <code>Bio.Tools.BLAST</code> module is a wrapper for the command line interface of <a href="https://www.ncbi.nlm.nih.gov/books/NBK279690/">BLAST+</a> from NCBI. It requires that you have BLAST+ <a href="https://www.ncbi.nlm.nih.gov/books/NBK279671/">installed</a> and accessible in your PATH (eg. you should be able to execute <code>$ blastn -h</code> from the command line).</p>
<p><a id='The-Basics-1'></a></p>
<h3 id="the-basics">The Basics</h3>
<p>This module allows you to run protein and nucleotide BLAST (<code>blastp</code> and <code>blastn</code> respectively) within julia and to parse BLAST results into Bio.jl types.</p>
<div class="codehilite"><pre><span></span><span class="k">using</span> <span class="n">Bio</span><span class="o">.</span><span class="n">Seq</span><span class="p">,</span>
      <span class="n">Bio</span><span class="o">.</span><span class="n">Tools</span><span class="o">.</span><span class="n">BLAST</span>

<span class="n">seq1</span> <span class="o">=</span> <span class="n">dna</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">CGGACCAGACGGACACAGGGAGAAGCTAGTTTCTTTCATGTGATTGANAT</span>
<span class="s">NATGACTCTACTCCTAAAAGGGAAAAANCAATATCCTTGTTTACAGAAGA</span>
<span class="s">GAAACAAACAAGCCCCACTCAGCTCAGTCACAGGAGAGAN</span>
<span class="s">&quot;&quot;&quot;</span>

<span class="n">seq2</span> <span class="o">=</span> <span class="n">dna</span><span class="s">&quot;&quot;&quot;</span>
<span class="s">CGGAGCCAGCGAGCATATGCTGCATGAGGACCTTTCTATCTTACATTATG</span>
<span class="s">GCTGGGAATCTTACTCTTTCATCTGATACCTTGTTCAGATTTCAAAATAG</span>
<span class="s">TTGTAGCCTTATCCTGGTTTTACAGATGTGAAACTTTCAA</span>
<span class="s">&quot;&quot;&quot;</span>

<span class="n">blastn</span><span class="p">(</span><span class="n">seq1</span><span class="p">,</span> <span class="n">seq2</span><span class="p">)</span>
</pre></div>


<p>These functions return a <code>Vector{BLASTResult}</code>. Each element is a hit which includes the sequence of the hit, an <a href="http://biojulia.github.io/Bio.jl/latest/man/alignments/"><code>AlignedSequence</code></a> using the original query as a reference and some additional information (expect vaue, bitscore) for the hit.</p>
<div class="codehilite"><pre><span></span><span class="k">immutable</span> <span class="n">BLASTResult</span>
    <span class="n">bitscore</span><span class="p">::</span><span class="kt">Float64</span>
    <span class="n">expect</span><span class="p">::</span><span class="kt">Float64</span>
    <span class="n">queryname</span><span class="p">::</span><span class="n">ASCIIString</span>
    <span class="n">hitname</span><span class="p">::</span><span class="n">ASCIIString</span>
    <span class="n">hit</span><span class="p">::</span><span class="n">BioSequence</span>
    <span class="n">alignment</span><span class="p">::</span><span class="n">AlignedSequence</span>
<span class="k">end</span>
</pre></div>


<p>If you've already run a blast analysis or have downloaded blast results in XML format from NCBI you can also pass an XML string to <code>readblastXML()</code> in order to obtain an array of <code>BLASTResult</code>s.</p>
<div class="codehilite"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="n">readall</span><span class="p">(</span><span class="n">open</span><span class="p">(</span><span class="s">&quot;blast_results.xml&quot;</span><span class="p">))</span> <span class="c"># need to use `readstring` instead of `readall` for v0.5</span>
<span class="n">readblastXML</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>


<p>When parsing protein blast results, you must include the argument <code>seqtype="prot"</code>, eg. <code>readblastXML("results, seqtype="prot")</code></p>
<p><a id='Options-for-blastn-and-blastp-1'></a></p>
<h3 id="options-for-blastn-and-blastp">Options for <code>blastn</code> and <code>blastp</code></h3>
<p>Both of the basic BLAST+ commands can accept a single <code>BioSequence</code>, a <code>Vector{BioSequence}</code> or a sting representing a file path to a fasta formatted file as arguments for both <code>query</code> and <code>subject</code>.</p>
<div class="codehilite"><pre><span></span><span class="n">blastn</span><span class="p">([</span><span class="n">seq1</span><span class="p">,</span> <span class="n">seq2</span><span class="p">],</span> <span class="p">[</span><span class="n">seq2</span><span class="p">,</span> <span class="n">seq3</span><span class="p">])</span>

<span class="n">blastp</span><span class="p">(</span><span class="n">aaseq</span><span class="p">,</span> <span class="s">&quot;path/to/sequences.fasta&quot;</span><span class="p">)</span>
</pre></div>


<p>If you have a local blast database (eg through the use of <code>$ makeblastdb</code>), you can use this database as the <code>subject</code></p>
<div class="codehilite"><pre><span></span><span class="n">blastn</span><span class="p">(</span><span class="n">seq1</span><span class="p">,</span> <span class="s">&quot;path/to/blast_db&quot;</span><span class="p">,</span> <span class="n">db</span><span class="o">=</span><span class="n">true</span><span class="p">)</span>
</pre></div>


<p>If you want to modify the search using additional options (eg. return only results with greater than 90% identity), you may pass a <code>Vector</code> of flags (see <a href="http://www.ncbi.nlm.nih.gov/books/NBK279675/">here</a> for valid arguments - do not use flags that will alter file handling such as <code>-outfmt</code>)</p>
<div class="codehilite"><pre><span></span><span class="n">blastn</span><span class="p">(</span><span class="n">seq1</span><span class="p">,</span> <span class="n">seq2</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;-perc_identity&quot;</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="s">&quot;-evalue&quot;</span><span class="p">,</span> <span class="s">&quot;9.0&quot;</span><span class="p">])</span>
</pre></div></div>
        
    </div>

    <footer class="col-md-12 text-center">
        <hr>
        <p>
        <small>Copyright (c) 2016 The BioJulia Organisation<br></small>
        
        <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p></small>
    </footer>

    <script src="../../js/jquery-1.10.2.min.js"></script>
    <script src="../../js/bootstrap-3.0.3.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script>
    var base_url = '../..';
    </script>
    <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
    <script src="../../js/base.js"></script>
    <script>
        ((window.gitter = {}).chat = {}).options = {
            room: 'BioJulia/Bio.jl'
        };
    </script>
    <script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
    <script src="../../assets/mathjaxhelper.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    </body>

</html>
