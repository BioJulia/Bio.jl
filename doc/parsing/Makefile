
 # Run ragel to regenerate parsers after updating the .rl source file

parsers=bed3.jl

all: ${parsers}

clean:
	rm -f ${parsers}

%.jl: %.rl
	ragel -U -G2 $< -o $@.tmp
	echo "# WARNING: This file was generated from $< using ragel. Do not edit!" > $@
	sed 's/[[:space:]]*$$//g' $@.tmp >> $@
	rm $@.tmp

# TODO: dumping DFA graphs is currently broken on ragel 7.0, so I'm using ragel 6.8
%.dot: %.rl
	~/src/ragel-6.8/ragel/ragel -p -V $< > $@

%.svg: %.dot
	dot -Tsvg < $< > $@

