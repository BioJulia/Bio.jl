RAGEL=ragel

all: parser.jl

clean:
	rm -f parser.jl

%.jl: %.rl
	$(RAGEL) -Y --goto-backend -G2 $< -o $@.tmp
	echo "# WARNING: This file was generated from $< using ragel. Do not edit!" > $@
	sed 's/[[:space:]]*$$//g' $@.tmp >> $@
	rm $@.tmp

%.dot: %.rl
	ragel -p -V $< > $@

%.svg: %.dot
	dot -Tsvg < $< > $@
